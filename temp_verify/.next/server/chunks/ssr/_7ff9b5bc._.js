module.exports=[5050,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={callServer:function(){return f.callServer},createServerReference:function(){return h.createServerReference},findSourceMapURL:function(){return g.findSourceMapURL}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(20611),g=a.r(1722),h=a.r(38783)},76971,46842,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);a.s(["Ticket",()=>c],76971);let d=(0,b.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>d],46842)},82406,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(5050);let e=(0,d.createServerReference)("7060889634000bdcd1443d814fa982ef01a06e05e1",d.callServer,void 0,d.findSourceMapURL,"createTurn"),f=(0,d.createServerReference)("40625cfbdc550bbe4f8855363b94e3aa4a94a0bbb4",d.callServer,void 0,d.findSourceMapURL,"getMyTurnStatus");var g=a.i(12466),h=a.i(46271),i=a.i(62036);let j=(0,a.i(70106).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var k=a.i(76971),l=a.i(46842),m=a.i(98621);function n({clinic:a}){let[d,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!0),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)(1),[w,x]=(0,c.useState)({});(0,c.useEffect)(()=>{let b=localStorage.getItem(`turn_${a.slug}`);if(b)try{n(JSON.parse(b))}catch(b){console.error("Failed to parse ticket",b),localStorage.removeItem(`turn_${a.slug}`)}r(!1)},[a.slug]),(0,c.useEffect)(()=>{if(!d)return;let a=async()=>{try{let a=await f(d.turnId);a.success&&a.turn?p(a):a.error}catch(a){console.error(a)}};a();let b=setInterval(a,5e3);return()=>clearInterval(b)},[d,a.slug]);let y=(a,b)=>{x(c=>({...c,[a]:b}))},z=async()=>{if(a.questions&&a.questions.length>0&&1===u)return void v(2);t(!0);try{let b=a.questions?.reduce((a,b)=>(a[b.text]=w[b.id],a),{}),c=await e(a.slug,void 0,b);if(c.success&&c.turn){let b={turnId:c.turn.id,ticketCode:c.turn.ticketCode,clinicSlug:a.slug};localStorage.setItem(`turn_${a.slug}`,JSON.stringify(b)),n(b)}}catch(a){console.error(a)}finally{t(!1)}},[A,B]=(0,c.useState)(!1);if(q)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)(j,{className:"animate-spin text-primary"})});if(!d)return a.questions&&a.questions.length>0&&2===u?(0,b.jsxs)("div",{dir:"rtl",className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center text-center",children:[(0,b.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-xl overflow-hidden animate-in fade-in zoom-in duration-300 border border-slate-100 p-8 text-right relative z-10",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-8",children:[(0,b.jsx)("div",{className:"w-10 h-10 bg-indigo-50 text-indigo-600 rounded-xl flex items-center justify-center",children:(0,b.jsx)(l.User,{className:"w-5 h-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-bold text-slate-800 leading-tight",children:"أخبرنا المزيد"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"بعض الأسئلة لتحضير زيارتك."})]})]}),(0,b.jsx)("div",{className:"space-y-6 mb-8",children:a.questions.map(a=>(0,b.jsxs)("div",{className:"group",children:[(0,b.jsxs)("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 mr-1 group-focus-within:text-primary transition-colors",children:[a.text," ",a.required&&(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),"TEXT"===a.type?(0,b.jsx)("input",{className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-4 focus:ring-primary/10 focus:border-primary transition-all duration-300",placeholder:a.placeholder||"إجابتك...",value:w[a.id]||"",onChange:b=>y(a.id,b.target.value),autoFocus:!0}):(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:JSON.parse(a.options||"[]").map(c=>(0,b.jsx)("button",{className:(0,m.default)("px-4 py-2 rounded-xl text-sm font-medium border transition-all duration-200",w[a.id]===c?"bg-primary text-white border-primary shadow-lg shadow-primary/25 scale-105":"bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:bg-slate-50"),onClick:()=>y(a.id,c),children:c},c))})]},a.id))}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)(g.Button,{variant:"outline",className:"h-12 rounded-xl border-slate-200 hover:bg-slate-50 hover:text-slate-900 font-medium text-slate-500",onClick:()=>v(1),children:"عودة"}),(0,b.jsx)(g.Button,{className:"h-12 rounded-xl bg-gradient-to-r from-primary to-indigo-600 hover:from-primary/90 hover:to-indigo-600/90 shadow-lg shadow-primary/25 transition-all hover:scale-[1.02]",onClick:z,disabled:s,children:s?(0,b.jsx)(j,{className:"w-5 h-5 animate-spin"}):"تأكيد"})]})]}),(0,b.jsx)("p",{className:"mt-8 text-slate-400 text-xs",children:"مشغل بواسطة ClinicFlow"})]}):(0,b.jsxs)("div",{dir:"rtl",className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center text-center",children:[(0,b.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-xl overflow-hidden animate-in fade-in zoom-in duration-500 p-8 text-center relative z-10 border border-slate-100",children:[a.logo?(0,b.jsx)("div",{className:"mb-6 flex justify-center",children:(0,b.jsx)("div",{className:"w-24 h-24 bg-white rounded-2xl shadow-sm flex items-center justify-center p-2 border border-slate-100",children:(0,b.jsx)("img",{src:a.logo,alt:a.name,className:"w-full h-full object-contain"})})}):(0,b.jsx)("div",{className:"mb-6 flex justify-center",children:(0,b.jsx)("div",{className:"w-20 h-20 bg-primary/10 rounded-2xl flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-3xl font-bold text-primary",children:a.name.charAt(0).toUpperCase()})})}),(0,b.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:a.name}),(0,b.jsx)("p",{className:"text-slate-500 text-sm mb-8 px-4 leading-relaxed",children:"امسح رمز الاستجابة السريعة أو انقر أدناه للانضمام إلى قائمة الانتظار."}),(0,b.jsxs)(g.Button,{size:"lg",className:"w-full h-14 text-lg rounded-xl shadow-lg shadow-primary/20 hover:scale-[1.02] transition-transform",onClick:()=>{a.questions&&a.questions.length>0?v(2):z()},disabled:s,children:[s?(0,b.jsx)(j,{className:"animate-spin ml-2"}):(0,b.jsx)(k.Ticket,{className:"ml-2 w-5 h-5"}),"احجز تذكرة"]})]}),(0,b.jsx)("p",{className:"mt-8 text-slate-400 text-xs",children:"مشغل بواسطة ClinicFlow"})]});let C=o?.turn,D=o?.peopleAhead||0,E=o?.estimatedTime||0,F=C?.status==="ACTIVE",G=C?.status==="DONE",H=C?.status==="CANCELLED";return(0,b.jsxs)("div",{dir:"rtl",className:"min-h-screen bg-slate-50 p-6 flex flex-col",children:[(0,b.jsxs)("header",{className:"flex justify-between items-center mb-6",children:[(0,b.jsx)("span",{className:"font-bold text-slate-700",children:a.name}),(0,b.jsxs)("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 text-xs font-mono text-slate-500",children:["#",d.ticketCode]})]}),(0,b.jsx)("main",{className:"flex-1 flex flex-col justify-center",children:(0,b.jsxs)("div",{className:"bg-white rounded-3xl p-8 shadow-xl border border-slate-100 text-center relative overflow-hidden",children:[F&&(0,b.jsx)("div",{className:"absolute top-0 left-0 w-full h-2 bg-green-500 animate-pulse"}),H&&(0,b.jsx)("div",{className:"absolute top-0 left-0 w-full h-2 bg-red-500"}),(0,b.jsxs)(h.motion.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"py-6",children:[(0,b.jsx)("div",{className:"mb-6",children:F?(0,b.jsx)("span",{className:"text-green-500 font-bold text-2xl animate-pulse",children:"حان دورك!"}):G?(0,b.jsx)("span",{className:"text-slate-400 font-medium",children:"انتهت الزيارة"}):H?(0,b.jsx)("span",{className:"text-red-400 font-medium",children:"تم إلغاء التذكرة"}):(0,b.jsx)("span",{className:"text-slate-400 font-medium uppercase tracking-widest text-xs",children:"الحالة الحالية"})}),(0,b.jsx)("div",{className:(0,m.default)("text-6xl font-bold mb-2 tracking-tighter",F?"text-green-600":H?"text-slate-300 line-through":"text-slate-800"),children:d.ticketCode}),!F&&!G&&!H&&(0,b.jsxs)("div",{className:"mt-8 flex justify-center gap-8 border-t border-dashed border-slate-100 pt-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-slate-800",children:D}),(0,b.jsx)("div",{className:"text-xs text-slate-400 uppercase tracking-wide mt-1",children:"أشخاص قبلك"})]}),(0,b.jsx)("div",{className:"w-px bg-slate-100"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-2xl font-bold text-primary",children:0===D?"وشيك":`~${E}د`}),(0,b.jsx)("div",{className:"text-xs text-slate-400 uppercase tracking-wide mt-1",children:"الوقت المقدر"})]})]}),F&&(0,b.jsx)("p",{className:"mt-4 text-green-700 bg-green-50 p-4 rounded-xl text-sm border border-green-100",children:"يرجى التوجه إلى الاستقبال أو مكتب الطبيب فوراً."})]},C?.status||"loading")]})}),(0,b.jsxs)("footer",{className:"mt-8",children:[!G&&!H&&(0,b.jsx)(g.Button,{variant:"ghost",className:"w-full text-slate-400 hover:text-red-500 hover:bg-red-50",onClick:()=>{B(!0)},children:"إلغاء التذكرة"}),(G||H)&&(0,b.jsx)(g.Button,{className:"w-full",onClick:()=>{localStorage.removeItem(`turn_${a.slug}`),n(null)},children:"إغلاق"})]}),(0,b.jsx)(i.AnimatePresence,{children:A&&(0,b.jsx)(h.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>B(!1),children:(0,b.jsx)(h.motion.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden",onClick:a=>a.stopPropagation(),children:(0,b.jsxs)("div",{className:"p-6 text-center",children:[(0,b.jsx)("div",{className:"w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,b.jsx)(k.Ticket,{className:"w-8 h-8"})}),(0,b.jsx)("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"هل أنت متأكد؟"}),(0,b.jsx)("p",{className:"text-slate-500 text-sm leading-relaxed mb-6",children:"هل تريد حقاً مغادرة قائمة الانتظار؟ ستفقد دورك ولن تتمكن من استعادته."}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)(g.Button,{variant:"outline",className:"rounded-xl border-slate-200 hover:bg-slate-50 text-slate-600",onClick:()=>B(!1),children:"تراجع"}),(0,b.jsx)(g.Button,{className:"rounded-xl bg-red-500 hover:bg-red-600 text-white shadow-lg shadow-red-200",onClick:()=>{localStorage.removeItem(`turn_${a.slug}`),n(null),p(null),B(!1)},children:"نعم، غادر"})]})]})})})})]})}a.s(["default",()=>n],82406)}];

//# sourceMappingURL=_7ff9b5bc._.js.map