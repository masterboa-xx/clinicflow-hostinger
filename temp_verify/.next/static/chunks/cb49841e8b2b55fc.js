(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95187,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s={callServer:function(){return a.callServer},createServerReference:function(){return n.createServerReference},findSourceMapURL:function(){return i.findSourceMapURL}};for(var l in s)Object.defineProperty(r,l,{enumerable:!0,get:s[l]});let a=e.r(32120),i=e.r(92245),n=e.r(35326)},7670,e=>{"use strict";function t(){for(var e,t,r=0,s="",l=arguments.length;r<l;r++)(e=arguments[r])&&(t=function e(t){var r,s,l="";if("string"==typeof t||"number"==typeof t)l+=t;else if("object"==typeof t)if(Array.isArray(t)){var a=t.length;for(r=0;r<a;r++)t[r]&&(s=e(t[r]))&&(l&&(l+=" "),l+=s)}else for(s in t)t[s]&&(l&&(l+=" "),l+=s);return l}(e))&&(s&&(s+=" "),s+=t);return s}e.s(["clsx",()=>t,"default",0,t])},75254,e=>{"use strict";var t=e.i(71645);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=(...e)=>e.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim();var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let a=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:n="",children:o,iconNode:c,...d},u)=>(0,t.createElement)("svg",{ref:u,...l,width:r,height:r,stroke:e,strokeWidth:i?24*Number(a)/Number(r):a,className:s("lucide",n),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(o)?o:[o]])),i=(e,l)=>{let i=(0,t.forwardRef)(({className:i,...n},o)=>(0,t.createElement)(a,{ref:o,iconNode:l,className:s(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...n}));return i.displayName=r(e),i};e.s(["default",()=>i],75254)},88653,e=>{"use strict";e.i(47167);var t=e.i(43476),r=e.i(71645),s=e.i(31178),l=e.i(47414),a=e.i(74008),i=e.i(21476),n=e.i(72846),o=r,c=e.i(37806);function d(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class u extends o.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,r=(0,n.isHTMLElement)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=r-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function x({children:e,isPresent:s,anchorX:l,root:a}){let i=(0,o.useId)(),n=(0,o.useRef)(null),x=(0,o.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:m}=(0,o.useContext)(c.MotionConfigContext),h=function(...e){return r.useCallback(function(...e){return t=>{let r=!1,s=e.map(e=>{let s=d(e,t);return r||"function"!=typeof s||(r=!0),s});if(r)return()=>{for(let t=0;t<s.length;t++){let r=s[t];"function"==typeof r?r():d(e[t],null)}}}}(...e),e)}(n,e.props?.ref??e?.ref);return(0,o.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:o,right:c}=x.current;if(s||!n.current||!e||!t)return;let d="left"===l?`left: ${o}`:`right: ${c}`;n.current.dataset.motionPopId=i;let u=document.createElement("style");m&&(u.nonce=m);let h=a??document.head;return h.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${t}px !important;
            ${d}px !important;
            top: ${r}px !important;
          }
        `),()=>{h.contains(u)&&h.removeChild(u)}},[s]),(0,t.jsx)(u,{isPresent:s,childRef:n,sizeRef:x,children:o.cloneElement(e,{ref:h})})}let m=({children:e,initial:s,isPresent:a,onExitComplete:n,custom:o,presenceAffectsLayout:c,mode:d,anchorX:u,root:m})=>{let f=(0,l.useConstant)(h),p=(0,r.useId)(),g=!0,v=(0,r.useMemo)(()=>(g=!1,{id:p,initial:s,isPresent:a,custom:o,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;n&&n()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[a,f,n]);return c&&g&&(v={...v}),(0,r.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[a]),r.useEffect(()=>{a||f.size||!n||n()},[a]),"popLayout"===d&&(e=(0,t.jsx)(x,{isPresent:a,anchorX:u,root:m,children:e})),(0,t.jsx)(i.PresenceContext.Provider,{value:v,children:e})};function h(){return new Map}var f=e.i(64978);let p=e=>e.key||"";function g(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let v=({children:e,custom:i,initial:n=!0,onExitComplete:o,presenceAffectsLayout:c=!0,mode:d="sync",propagate:u=!1,anchorX:x="left",root:h})=>{let[v,b]=(0,f.usePresence)(u),j=(0,r.useMemo)(()=>g(e),[e]),w=u&&!v?[]:j.map(p),y=(0,r.useRef)(!0),N=(0,r.useRef)(j),C=(0,l.useConstant)(()=>new Map),k=(0,r.useRef)(new Set),[S,E]=(0,r.useState)(j),[R,M]=(0,r.useState)(j);(0,a.useIsomorphicLayoutEffect)(()=>{y.current=!1,N.current=j;for(let e=0;e<R.length;e++){let t=p(R[e]);w.includes(t)?(C.delete(t),k.current.delete(t)):!0!==C.get(t)&&C.set(t,!1)}},[R,w.length,w.join("-")]);let P=[];if(j!==S){let e=[...j];for(let t=0;t<R.length;t++){let r=R[t],s=p(r);w.includes(s)||(e.splice(t,0,r),P.push(r))}return"wait"===d&&P.length&&(e=P),M(g(e)),E(j),null}let{forceRender:$}=(0,r.useContext)(s.LayoutGroupContext);return(0,t.jsx)(t.Fragment,{children:R.map(e=>{let r=p(e),s=(!u||!!v)&&(j===R||w.includes(r));return(0,t.jsx)(m,{isPresent:s,initial:(!y.current||!!n)&&void 0,custom:i,presenceAffectsLayout:c,mode:d,root:h,onExitComplete:s?void 0:()=>{if(k.current.has(r)||(k.current.add(r),!C.has(r)))return;C.set(r,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&($?.(),M(N.current),u&&b?.(),o&&o())},anchorX:x,children:e},r)})})};e.s(["AnimatePresence",()=>v],88653)},8402,84614,e=>{"use strict";var t=e.i(75254);let r=(0,t.default)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);e.s(["Ticket",()=>r],8402);let s=(0,t.default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>s],84614)},25380,e=>{"use strict";var t=e.i(43476),r=e.i(71645),s=e.i(95187);let l=(0,s.createServerReference)("7060889634000bdcd1443d814fa982ef01a06e05e1",s.callServer,void 0,s.findSourceMapURL,"createTurn"),a=(0,s.createServerReference)("40625cfbdc550bbe4f8855363b94e3aa4a94a0bbb4",s.callServer,void 0,s.findSourceMapURL,"getMyTurnStatus");var i=e.i(76525),n=e.i(46932),o=e.i(88653);let c=(0,e.i(75254).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var d=e.i(8402),u=e.i(84614),x=e.i(7670);function m({clinic:e}){let[s,m]=(0,r.useState)(null),[h,f]=(0,r.useState)(null),[p,g]=(0,r.useState)(!0),[v,b]=(0,r.useState)(!1),[j,w]=(0,r.useState)(1),[y,N]=(0,r.useState)({});(0,r.useEffect)(()=>{let t=localStorage.getItem(`turn_${e.slug}`);if(t)try{m(JSON.parse(t))}catch(t){console.error("Failed to parse ticket",t),localStorage.removeItem(`turn_${e.slug}`)}g(!1)},[e.slug]),(0,r.useEffect)(()=>{if(!s)return;let e=async()=>{try{let e=await a(s.turnId);e.success&&e.turn?f(e):e.error}catch(e){console.error(e)}};e();let t=setInterval(e,5e3);return()=>clearInterval(t)},[s,e.slug]);let C=(e,t)=>{N(r=>({...r,[e]:t}))},k=async()=>{if(e.questions&&e.questions.length>0&&1===j)return void w(2);b(!0);try{let t=e.questions?.reduce((e,t)=>(e[t.text]=y[t.id],e),{}),r=await l(e.slug,void 0,t);if(r.success&&r.turn){let t={turnId:r.turn.id,ticketCode:r.turn.ticketCode,clinicSlug:e.slug};localStorage.setItem(`turn_${e.slug}`,JSON.stringify(t)),m(t)}}catch(e){console.error(e)}finally{b(!1)}},[S,E]=(0,r.useState)(!1);if(p)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)(c,{className:"animate-spin text-primary"})});if(!s)return e.questions&&e.questions.length>0&&2===j?(0,t.jsxs)("div",{dir:"rtl",className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center text-center",children:[(0,t.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-xl overflow-hidden animate-in fade-in zoom-in duration-300 border border-slate-100 p-8 text-right relative z-10",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-8",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-indigo-50 text-indigo-600 rounded-xl flex items-center justify-center",children:(0,t.jsx)(u.User,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-slate-800 leading-tight",children:"أخبرنا المزيد"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"بعض الأسئلة لتحضير زيارتك."})]})]}),(0,t.jsx)("div",{className:"space-y-6 mb-8",children:e.questions.map(e=>(0,t.jsxs)("div",{className:"group",children:[(0,t.jsxs)("label",{className:"block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2 mr-1 group-focus-within:text-primary transition-colors",children:[e.text," ",e.required&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),"TEXT"===e.type?(0,t.jsx)("input",{className:"w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-xl text-slate-800 placeholder:text-slate-400 focus:outline-none focus:ring-4 focus:ring-primary/10 focus:border-primary transition-all duration-300",placeholder:e.placeholder||"إجابتك...",value:y[e.id]||"",onChange:t=>C(e.id,t.target.value),autoFocus:!0}):(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:JSON.parse(e.options||"[]").map(r=>(0,t.jsx)("button",{className:(0,x.default)("px-4 py-2 rounded-xl text-sm font-medium border transition-all duration-200",y[e.id]===r?"bg-primary text-white border-primary shadow-lg shadow-primary/25 scale-105":"bg-white text-slate-600 border-slate-200 hover:border-slate-300 hover:bg-slate-50"),onClick:()=>C(e.id,r),children:r},r))})]},e.id))}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsx)(i.Button,{variant:"outline",className:"h-12 rounded-xl border-slate-200 hover:bg-slate-50 hover:text-slate-900 font-medium text-slate-500",onClick:()=>w(1),children:"عودة"}),(0,t.jsx)(i.Button,{className:"h-12 rounded-xl bg-gradient-to-r from-primary to-indigo-600 hover:from-primary/90 hover:to-indigo-600/90 shadow-lg shadow-primary/25 transition-all hover:scale-[1.02]",onClick:k,disabled:v,children:v?(0,t.jsx)(c,{className:"w-5 h-5 animate-spin"}):"تأكيد"})]})]}),(0,t.jsx)("p",{className:"mt-8 text-slate-400 text-xs",children:"مشغل بواسطة ClinicFlow"})]}):(0,t.jsxs)("div",{dir:"rtl",className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center text-center",children:[(0,t.jsxs)("div",{className:"w-full max-w-sm bg-white rounded-3xl shadow-xl overflow-hidden animate-in fade-in zoom-in duration-500 p-8 text-center relative z-10 border border-slate-100",children:[e.logo?(0,t.jsx)("div",{className:"mb-6 flex justify-center",children:(0,t.jsx)("div",{className:"w-24 h-24 bg-white rounded-2xl shadow-sm flex items-center justify-center p-2 border border-slate-100",children:(0,t.jsx)("img",{src:e.logo,alt:e.name,className:"w-full h-full object-contain"})})}):(0,t.jsx)("div",{className:"mb-6 flex justify-center",children:(0,t.jsx)("div",{className:"w-20 h-20 bg-primary/10 rounded-2xl flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-3xl font-bold text-primary",children:e.name.charAt(0).toUpperCase()})})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-slate-900 mb-2",children:e.name}),(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-8 px-4 leading-relaxed",children:"امسح رمز الاستجابة السريعة أو انقر أدناه للانضمام إلى قائمة الانتظار."}),(0,t.jsxs)(i.Button,{size:"lg",className:"w-full h-14 text-lg rounded-xl shadow-lg shadow-primary/20 hover:scale-[1.02] transition-transform",onClick:()=>{e.questions&&e.questions.length>0?w(2):k()},disabled:v,children:[v?(0,t.jsx)(c,{className:"animate-spin ml-2"}):(0,t.jsx)(d.Ticket,{className:"ml-2 w-5 h-5"}),"احجز تذكرة"]})]}),(0,t.jsx)("p",{className:"mt-8 text-slate-400 text-xs",children:"مشغل بواسطة ClinicFlow"})]});let R=h?.turn,M=h?.peopleAhead||0,P=h?.estimatedTime||0,$=R?.status==="ACTIVE",A=R?.status==="DONE",L=R?.status==="CANCELLED";return(0,t.jsxs)("div",{dir:"rtl",className:"min-h-screen bg-slate-50 p-6 flex flex-col",children:[(0,t.jsxs)("header",{className:"flex justify-between items-center mb-6",children:[(0,t.jsx)("span",{className:"font-bold text-slate-700",children:e.name}),(0,t.jsxs)("div",{className:"bg-white px-3 py-1 rounded-full border border-slate-200 text-xs font-mono text-slate-500",children:["#",s.ticketCode]})]}),(0,t.jsx)("main",{className:"flex-1 flex flex-col justify-center",children:(0,t.jsxs)("div",{className:"bg-white rounded-3xl p-8 shadow-xl border border-slate-100 text-center relative overflow-hidden",children:[$&&(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-2 bg-green-500 animate-pulse"}),L&&(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-2 bg-red-500"}),(0,t.jsxs)(n.motion.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"py-6",children:[(0,t.jsx)("div",{className:"mb-6",children:$?(0,t.jsx)("span",{className:"text-green-500 font-bold text-2xl animate-pulse",children:"حان دورك!"}):A?(0,t.jsx)("span",{className:"text-slate-400 font-medium",children:"انتهت الزيارة"}):L?(0,t.jsx)("span",{className:"text-red-400 font-medium",children:"تم إلغاء التذكرة"}):(0,t.jsx)("span",{className:"text-slate-400 font-medium uppercase tracking-widest text-xs",children:"الحالة الحالية"})}),(0,t.jsx)("div",{className:(0,x.default)("text-6xl font-bold mb-2 tracking-tighter",$?"text-green-600":L?"text-slate-300 line-through":"text-slate-800"),children:s.ticketCode}),!$&&!A&&!L&&(0,t.jsxs)("div",{className:"mt-8 flex justify-center gap-8 border-t border-dashed border-slate-100 pt-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-slate-800",children:M}),(0,t.jsx)("div",{className:"text-xs text-slate-400 uppercase tracking-wide mt-1",children:"أشخاص قبلك"})]}),(0,t.jsx)("div",{className:"w-px bg-slate-100"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-primary",children:0===M?"وشيك":`~${P}د`}),(0,t.jsx)("div",{className:"text-xs text-slate-400 uppercase tracking-wide mt-1",children:"الوقت المقدر"})]})]}),$&&(0,t.jsx)("p",{className:"mt-4 text-green-700 bg-green-50 p-4 rounded-xl text-sm border border-green-100",children:"يرجى التوجه إلى الاستقبال أو مكتب الطبيب فوراً."})]},R?.status||"loading")]})}),(0,t.jsxs)("footer",{className:"mt-8",children:[!A&&!L&&(0,t.jsx)(i.Button,{variant:"ghost",className:"w-full text-slate-400 hover:text-red-500 hover:bg-red-50",onClick:()=>{E(!0)},children:"إلغاء التذكرة"}),(A||L)&&(0,t.jsx)(i.Button,{className:"w-full",onClick:()=>{localStorage.removeItem(`turn_${e.slug}`),m(null)},children:"إغلاق"})]}),(0,t.jsx)(o.AnimatePresence,{children:S&&(0,t.jsx)(n.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:()=>E(!1),children:(0,t.jsx)(n.motion.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-3xl shadow-2xl w-full max-w-sm overflow-hidden",onClick:e=>e.stopPropagation(),children:(0,t.jsxs)("div",{className:"p-6 text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(d.Ticket,{className:"w-8 h-8"})}),(0,t.jsx)("h3",{className:"text-xl font-bold text-slate-900 mb-2",children:"هل أنت متأكد؟"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm leading-relaxed mb-6",children:"هل تريد حقاً مغادرة قائمة الانتظار؟ ستفقد دورك ولن تتمكن من استعادته."}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsx)(i.Button,{variant:"outline",className:"rounded-xl border-slate-200 hover:bg-slate-50 text-slate-600",onClick:()=>E(!1),children:"تراجع"}),(0,t.jsx)(i.Button,{className:"rounded-xl bg-red-500 hover:bg-red-600 text-white shadow-lg shadow-red-200",onClick:()=>{localStorage.removeItem(`turn_${e.slug}`),m(null),f(null),E(!1)},children:"نعم، غادر"})]})]})})})})]})}e.s(["default",()=>m],25380)}]);